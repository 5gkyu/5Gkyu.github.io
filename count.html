<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>カウンター — 超大ボタン</title>
<style>
  :root{
    --accent: #0b84ff;
    --muted: #666;
    --page-bg: #ffffff; /* 常に白 */
  }

  html,body{
    height:100%;
    margin:0;
    font-family: "Yu Gothic UI", "Hiragino Kaku Gothic ProN", "Noto Sans JP", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    background-color: var(--page-bg);
    color:#111;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
  }

  .app{
    min-height:100vh;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    position:relative;
    padding:24px;
    box-sizing:border-box;
  }

  /* タイトル — 大きめ */
  header{
    position: absolute;
    top: 18px;
    left: 50%;
    transform: translateX(-50%);
    text-align:center;
    z-index:2;
  }
  header h1{
    margin:0;
    font-weight:900;
    font-size: clamp(32px, 6.5vw, 72px);
    letter-spacing: .02em;
  }

  /* 設定ボタン（右上） */
  .settings-btn{
    position: absolute;
    top: 12px;
    right: 12px;
    z-index: 3;
  }
  .settings-btn button{
    border: none;
    background: rgba(250,250,250,0.95);
    padding:10px 12px;
    border-radius:10px;
    cursor:pointer;
    box-shadow: 0 4px 18px rgba(0,0,0,0.08);
    font-weight:700;
  }

  .counter-wrap{
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:24px;
  }

  /* 中央の数字 — 縁取りのみを強調 */
  .value{
    font-weight:900;
    font-size: clamp(88px, 24vw, 340px); /* さらに大きく */
    line-height:1;
    text-align:center;
    user-select: none;
    color: #0b1220;
    background: none; /* カード背景はなし */
    padding: 8px 12px;
    border-radius: 12px;
    min-width: 6ch;
    /* 明確な縁取りを -webkit-text-stroke と影で補強 */
    -webkit-text-stroke: 6px rgba(0,0,0,0.32);
    text-shadow: 0 6px 26px rgba(11,18,32,0.12);
  }

  .controls{
    display:flex;
    gap:24px;
    align-items:center;
    justify-content:center;
  }

  .btn{
    border: none;
    cursor:pointer;
    user-select:none;
    display:inline-flex;
    align-items:center;
    justify-content:center;
    transition: transform .08s ease, box-shadow .12s ease;
    box-shadow: 0 8px 24px rgba(0,0,0,0.07);
    background: #fafafa;
    color: #111;
    border-radius:12px;
    font-weight:800;
  }
  .btn:active{ transform: translateY(3px); }

  /* 減らすボタンは小さめ */
  .btn--dec{
    padding:10px 14px;
    font-size:20px;
    border-radius:12px;
    min-width:64px;
    min-height:44px;
  }

  /* 増やすボタン — 四角で「やりすぎ」サイズ */
  .btn--inc{
    width: clamp(220px, 44vw, 720px);
    height: clamp(220px, 44vw, 720px);
    font-size: clamp(48px, 12vw, 200px);
    padding:0;
    border-radius:12px; /* 四角寄り */
    background: linear-gradient(180deg,var(--accent), #0666c9);
    color:white;
    box-shadow: 0 28px 80px rgba(11,132,255,0.32), 0 8px 30px rgba(0,0,0,0.10);
    display:inline-grid;
    place-items:center;
  }

  /* 設定パネル（背景関連は除去） */
  .panel{
    position: fixed;
    top: 78px;
    right: 12px;
    width: 360px;
    max-width: calc(100% - 24px);
    background: rgba(255,255,255,0.98);
    border-radius:12px;
    box-shadow: 0 12px 40px rgba(0,0,0,0.12);
    padding:14px;
    z-index: 4;
    transform-origin: top right;
    transition: transform .18s cubic-bezier(.2,.9,.3,1), opacity .14s;
    opacity:0;
    transform: translateY(-8px) scale(.98);
    pointer-events:none;
  }
  .panel.open{ opacity:1; transform: translateY(0) scale(1); pointer-events:auto; }
  .panel h3{ margin:4px 0 10px 0; font-size:16px; }
  .panel .row{ display:flex; gap:8px; align-items:center; margin-bottom:10px; }
  .panel label{ font-size:13px; color:var(--muted); display:block; margin-bottom:6px; }
  .small{ font-size:13px; padding:8px 10px; border-radius:8px; background:#f6f6f6; border:1px solid #eee; }
  input[type="number"], input[type="text"]{ width:100%; padding:8px 10px; border-radius:8px; border:1px solid #e6e6e6; font-size:14px; box-sizing:border-box; }
  .muted{ color:var(--muted); font-size:13px; }

  footer{ position: absolute; bottom: 12px; left: 50%; transform: translateX(-50%); font-size:12px; color:var(--muted); z-index:2; }

  @media (max-width:420px){
    .panel{ right:8px; left:8px; width:auto; top:64px; }
    header h1{ font-size: clamp(24px, 8vw, 44px); }
  }
</style>
</head>
<body>
  <div class="app" role="application" aria-label="カウンターアプリ">
    <header>
      <h1 id="title" contenteditable="false" aria-live="polite">カウンター</h1>
    </header>

    <div class="settings-btn">
      <button id="toggleSettings" aria-expanded="false" aria-controls="settingsPanel" title="設定">⚙ 設定</button>
    </div>

    <main class="counter-wrap" role="main">
      <div class="value" id="value" aria-live="polite">0</div>

      <div class="controls" role="group" aria-label="カウント操作">
        <button class="btn btn--dec" id="decrement" aria-label="減らす −1">−</button>
        <button class="btn btn--inc" id="increment" aria-label="増やす ＋1">＋</button>
      </div>
    </main>

    <div class="panel" id="settingsPanel" role="region" aria-label="設定パネル" aria-hidden="true">
      <h3>設定</h3>

      <div class="row">
        <button class="small" id="resetBtn" title="0にリセット">0 にリセット</button>
        <button class="small" id="clearStorageBtn" title="保存をクリア">保存クリア</button>
      </div>

      <div class="row" style="flex-direction:column; gap:6px;">
        <label for="setValueInput">数値を直接入力</label>
        <div style="display:flex; gap:8px;">
          <input id="setValueInput" type="number" step="1" value="0" aria-label="数値を入力" />
          <button class="small" id="applyValueBtn">適用</button>
        </div>
      </div>

      <div class="row" style="flex-direction:column; gap:6px;">
        <label for="titleInput">タイトルを編集</label>
        <div style="display:flex; gap:8px;">
          <input id="titleInput" type="text" placeholder="タイトルを入力" />
          <button class="small" id="applyTitleBtn">適用</button>
        </div>
        <div class="muted">※タイトルを空にすると既定値に戻ります</div>
      </div>

      <div style="margin-top:8px; display:flex; gap:8px; justify-content:flex-end;">
        <button class="small" id="closePanel">閉じる</button>
      </div>
    </div>

    <footer>設定はローカルに保存されます（自動）</footer>
  </div>

<script>
(function(){
  const valueEl = document.getElementById('value');
  const incBtn = document.getElementById('increment');
  const decBtn = document.getElementById('decrement');

  const toggleBtn = document.getElementById('toggleSettings');
  const panel = document.getElementById('settingsPanel');
  const closePanelBtn = document.getElementById('closePanel');

  const resetBtn = document.getElementById('resetBtn');
  const setValueInput = document.getElementById('setValueInput');
  const applyValueBtn = document.getElementById('applyValueBtn');

  const titleEl = document.getElementById('title');
  const titleInput = document.getElementById('titleInput');
  const applyTitleBtn = document.getElementById('applyTitleBtn');

  const clearStorageBtn = document.getElementById('clearStorageBtn');

  let count = 0;
  const STORAGE_KEY = 'oversized_counter_v2';

  function loadState(){
    try{
      const raw = localStorage.getItem(STORAGE_KEY);
      if(raw){
        const st = JSON.parse(raw);
        if(typeof st.count === 'number') count = st.count;
        if(st.title) titleEl.textContent = st.title;
      }
    }catch(e){ console.warn('state load err', e); }
    updateDisplay();
  }

  function saveState(){
    try{
      const obj = { count, title: titleEl.textContent || 'カウンター' };
      localStorage.setItem(STORAGE_KEY, JSON.stringify(obj));
    }catch(e){ console.warn('state save err', e); }
  }

  function updateDisplay(){
    valueEl.textContent = String(count);
    setValueInput.value = String(count);
    saveState();
  }

  incBtn.addEventListener('click', ()=>{ count = Number(count) + 1; updateDisplay(); incBtn.focus(); });
  decBtn.addEventListener('click', ()=>{ count = Number(count) - 1; updateDisplay(); decBtn.focus(); });

  function openPanel(){ panel.classList.add('open'); panel.setAttribute('aria-hidden','false'); toggleBtn.setAttribute('aria-expanded','true'); }
  function closePanel(){ panel.classList.remove('open'); panel.setAttribute('aria-hidden','true'); toggleBtn.setAttribute('aria-expanded','false'); }
  toggleBtn.addEventListener('click', ()=>{ if(panel.classList.contains('open')) closePanel(); else openPanel(); });
  closePanelBtn.addEventListener('click', closePanel);

  resetBtn.addEventListener('click', ()=>{ count = 0; updateDisplay(); closePanel(); });

  applyValueBtn.addEventListener('click', ()=>{
    const v = Number(setValueInput.value);
    if(Number.isFinite(v)) { count = Math.trunc(v); updateDisplay(); } else { alert('有効な整数を入力してください'); }
  });
  setValueInput.addEventListener('keydown', (e)=>{ if(e.key === 'Enter') applyValueBtn.click(); });

  applyTitleBtn.addEventListener('click', ()=>{ const t = titleInput.value.trim(); titleEl.textContent = t === '' ? 'カウンター' : t; titleInput.value=''; saveState(); });
  titleEl.addEventListener('dblclick', ()=>{ openPanel(); titleInput.value = titleEl.textContent; titleInput.focus(); });

  // キーボード操作
  window.addEventListener('keydown', (e)=>{
    if(e.target && (/input|textarea/i).test(e.target.tagName)) return;
    if(e.key === ' ' || e.key === 'Enter' || e.key === '+'){ e.preventDefault(); incBtn.click(); }
    else if(e.key === '-' || e.key === 'ArrowDown'){ e.preventDefault(); decBtn.click(); }
    else if(e.key === 'ArrowUp'){ e.preventDefault(); incBtn.click(); }
    else if(e.key === 's' && (e.ctrlKey || e.metaKey)){ e.preventDefault(); if(panel.classList.contains('open')) closePanel(); else openPanel(); }
  });

  // 初期化
  loadState();

  // フォーカスの簡易スタイル
  document.addEventListener('focusin', (e)=>{
    if(e.target && e.target.matches && e.target.matches('button, input, [contenteditable]')){
      e.target.style.outline = '3px solid rgba(11,132,255,0.12)'; e.target.style.outlineOffset = '4px';
    }
  });
  document.addEventListener('focusout', (e)=>{ if(e.target && e.target.style){ e.target.style.outline=''; e.target.style.outlineOffset=''; } });

})();
</script>
</body>
</html>
